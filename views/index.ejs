<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mystic Card Night – Special Edition</title>
  <link rel="stylesheet" href="/css/index.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Lora:ital,wght@0,400;0,600;1,400&family=Dancing+Script:wght@600&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- ============================================================
       OVERLAY: Lá bài A rút ra + phóng to che màn hình
  ============================================================ -->
  <div class="card-overlay" id="cardOverlay">
    <div class="ace-card-wrap" id="aceCardWrap">
      <img src="/images/lá A.png" alt="A cơ" class="ace-card-img" id="aceCard" />
    </div>
  </div>

  <!-- Top decorative line -->
  <div class="top-bar"></div>

  <!-- Header area -->
  <header class="site-header">
    <!-- Women Day badge (top-left) -->
    <div class="badge-wrap">
      <div class="badge">
        <svg class="badge-ring" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <path id="topArc"    d="M 15,60 A 45,45 0 0,1 105,60"/>
            <path id="bottomArc" d="M 105,60 A 45,45 0 0,1 15,60"/>
          </defs>
          <text font-size="11.5" fill="#c9a84c" font-family="'Lora', serif" letter-spacing="3">
            <textPath href="#topArc" startOffset="12%">WOMEN DAY</textPath>
          </text>
          <text font-size="11.5" fill="#c9a84c" font-family="'Lora', serif" letter-spacing="3">
            <textPath href="#bottomArc" startOffset="12%">WOMEN DAY</textPath>
          </text>
          <text x="57" y="22"  font-size="9" fill="#c9a84c" text-anchor="middle">♥</text>
          <text x="57" y="103" font-size="9" fill="#c9a84c" text-anchor="middle">♥</text>
        </svg>
        <div class="badge-heart">♥</div>
      </div>
    </div>

    <!-- Title block -->
    <div class="title-block">
      <h1 class="main-title">Mystic Card<br/>Night</h1>
      <p class="subtitle">Special Edition</p>
    </div>

    <!-- Hearts top-right -->
    <div class="hearts-right">
      <span class="heart-icon">♥</span>
      <span class="heart-icon">♥</span>
      <span class="heart-icon">♥</span>
    </div>
  </header>

  <!-- Bottom separator line -->
  <div class="header-line"></div>

  <!-- Main content -->
  <main class="main-content">
    <div class="card-fan-wrap">
      <img src="/images/ảnh bài.png" alt="Bài xòe" class="card-fan-img" />
      <div class="card-shadow"></div>
    </div>

    <!-- Start button -->
    <button class="btn-start" id="btnStart">
      <span>Start</span>
    </button>
  </main>

  <!-- ============================================================
       GRAMOPHONE – góc phải phía dưới
  ============================================================ -->
  <div class="gramophone-wrap" id="gramophoneWrap" title="Click để bật/tắt nhạc">

    <!--
      NỐT NHẠC: vị trí được set bằng `top` + `left` trong CSS (.music-notes).
      Sau khi gắn ảnh thật, mở DevTools (F12) và chỉnh:
        top  = khoảng cách từ đỉnh .gramophone-wrap đến miệng loa (px hoặc %)
        left = khoảng cách từ trái .gramophone-wrap đến miệng loa (px hoặc %)
      
      --x  của mỗi .note: số dương = nốt bay sang phải, âm = bay sang trái
      --delay: thời gian chờ trước khi note bắt đầu bay (giây)
    -->
    <div class="music-notes" id="musicNotes">
      <span class="note" style="--x:-22px; --delay:0s;   --size:1.1rem">♪</span>
      <span class="note" style="--x: 8px;  --delay:0.6s; --size:0.9rem">♫</span>
      <span class="note" style="--x:-36px; --delay:1.1s; --size:1.3rem">♩</span>
      <span class="note" style="--x: 18px; --delay:1.7s; --size:0.85rem">♬</span>
      <span class="note" style="--x:-10px; --delay:2.3s; --size:1rem">♪</span>
      <span class="note" style="--x: 28px; --delay:2.8s; --size:0.95rem">♫</span>
    </div>

    <!--
      ★ THAY src BẰNG ĐƯỜNG DẪN ẢNH MÁY CHƠI NHẠC CỦA BẠN ★
      Ví dụ: src="/images/gramophone.png"
    -->
    <img
      src="/images/loa.png"
      alt="Máy chơi nhạc cổ điển"
      class="gramophone-img"
      draggable="false"
    />

    <!-- Label nhỏ bên dưới -->
    <div class="gramophone-label">♪ Music</div>
  </div>

  <!-- ============================================================
       SCRIPT
  ============================================================ -->
  <script>
    const btnStart   = document.getElementById('btnStart');
    const overlay    = document.getElementById('cardOverlay');
    const aceWrap    = document.getElementById('aceCardWrap');
    const gramophone = document.getElementById('gramophoneWrap');
    const musicNotes = document.getElementById('musicNotes');

    // ── Nhạc nền ────────────────────────────────────────────────
    const bgMusic = new Audio('/sounds/Em Là Lý Do.mp3');
    bgMusic.loop    = true;
    bgMusic.volume  = 0.6;
    bgMusic.preload = 'auto';

    // ── Âm thanh rút bài ────────────────────────────────────────
    const cardSound = new Audio('/sounds/card flip.ogg');
    cardSound.preload = 'auto';

    // ── Bật/tắt hiệu ứng ────────────────────────────────────────
    function setMusicState(playing) {
      if (playing) {
        gramophone.classList.add('playing');
        musicNotes.classList.add('active');
      } else {
        gramophone.classList.remove('playing');
        musicNotes.classList.remove('active');
      }
    }

    // ── Click gramophone = toggle bật/tắt nhạc ──────────────────
    gramophone.addEventListener('click', () => {
      if (bgMusic.paused) {
        bgMusic.play().then(() => setMusicState(true)).catch(() => {});
      } else {
        bgMusic.pause();
        setMusicState(false);
      }
    });

    // ── Nút Start ───────────────────────────────────────────────
    btnStart.addEventListener('click', () => {
      btnStart.disabled = true;

      cardSound.currentTime = 0;
      cardSound.play().catch(() => {});

      overlay.classList.add('visible');
      aceWrap.classList.add('draw');

      setTimeout(() => { aceWrap.classList.add('expand'); }, 3200);
      setTimeout(() => { window.location.href = '/game'; }, 4900);
    });

    // ── Đồng bộ state nếu browser tự pause ──────────────────────
    bgMusic.addEventListener('play',  () => setMusicState(true));
    bgMusic.addEventListener('pause', () => setMusicState(false));
  </script>
</body>
</html>
