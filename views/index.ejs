<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mystic Card Night – Special Edition</title>
  <link rel="stylesheet" href="/css/index.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Lora:ital,wght@0,400;0,600;1,400&family=Dancing+Script:wght@600&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- Overlay trong suốt để unlock audio ngay khi user chạm/click lần đầu -->
  <div id="audioUnlock" style="
    position:fixed; inset:0; z-index:99999;
    cursor:pointer; background:transparent;
  "></div>

  <!-- ============================================================
       OVERLAY: Lá bài A rút ra + phóng to che màn hình
  ============================================================ -->
  <div class="card-overlay" id="cardOverlay">
    <div class="ace-card-wrap" id="aceCardWrap">
      <img src="/images/lá A.png" alt="A cơ" class="ace-card-img" id="aceCard" />
    </div>
  </div>

  <!-- Top decorative line -->
  <div class="top-bar"></div>

  <!-- Header area -->
  <header class="site-header">
    <!-- Women Day badge (top-left) -->
    <div class="badge-wrap">
      <div class="badge">
        <svg class="badge-ring" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <path id="topArc"    d="M 15,60 A 45,45 0 0,1 105,60"/>
            <path id="bottomArc" d="M 105,60 A 45,45 0 0,1 15,60"/>
          </defs>
          <text font-size="11.5" fill="#c9a84c" font-family="'Lora', serif" letter-spacing="3">
            <textPath href="#topArc" startOffset="12%">WOMEN DAY</textPath>
          </text>
          <text font-size="11.5" fill="#c9a84c" font-family="'Lora', serif" letter-spacing="3">
            <textPath href="#bottomArc" startOffset="12%">WOMEN DAY</textPath>
          </text>
          <text x="57" y="22"  font-size="9" fill="#c9a84c" text-anchor="middle">♥</text>
          <text x="57" y="103" font-size="9" fill="#c9a84c" text-anchor="middle">♥</text>
        </svg>
        <div class="badge-heart">♥</div>
      </div>
    </div>

    <!-- Title block -->
    <div class="title-block">
      <h1 class="main-title">Mystic Card<br/>Night</h1>
      <p class="subtitle">Special Edition</p>
    </div>

    <!-- Hearts top-right -->
    <div class="hearts-right">
      <span class="heart-icon">♥</span>
      <span class="heart-icon">♥</span>
      <span class="heart-icon">♥</span>
    </div>
  </header>

  <!-- Bottom separator line -->
  <div class="header-line"></div>

  <!-- Main content -->
  <main class="main-content">
    <div class="card-fan-wrap">
      <img src="/images/ảnh bài.png" alt="Bài xòe" class="card-fan-img" />
      <div class="card-shadow"></div>
    </div>

    <!-- Start button -->
    <button class="btn-start" id="btnStart">
      <span>Start</span>
    </button>
  </main>

  <!-- ============================================================
       SCRIPT
  ============================================================ -->
  <script>
    const btnStart = document.getElementById('btnStart');
    const overlay  = document.getElementById('cardOverlay');
    const aceWrap  = document.getElementById('aceCardWrap');

    // ── Nhạc nền (MP3) ──────────────────────────────────────────
    const bgMusic = new Audio('/sounds/Em Là Lý Do.mp3');
    bgMusic.loop    = true;
    bgMusic.volume  = 0.6;
    bgMusic.preload = 'auto';

    // ── Âm thanh rút bài ────────────────────────────────────────
    const cardSound = new Audio('/sounds/card flip.ogg');
    cardSound.preload = 'auto';

    // ── Overlay trong suốt — bắt click/touch đầu tiên để phát nhạc ──
    const audioUnlock = document.getElementById('audioUnlock');

    const doUnlock = () => {
      bgMusic.play().catch(() => {});
      audioUnlock.remove();
    };

    audioUnlock.addEventListener('click',      doUnlock, { once: true });
    audioUnlock.addEventListener('touchstart', doUnlock, { once: true });

    // ── Nút Start ───────────────────────────────────────────────
    btnStart.addEventListener('click', () => {
      btnStart.disabled = true;

      // Đảm bảo nhạc nền đang chạy
      if (bgMusic.paused) bgMusic.play().catch(() => {});

      // Phát âm thanh rút bài
      cardSound.currentTime = 0;
      cardSound.play().catch(() => {});

      // Bước 1 – Hiện overlay + lá bài trượt lên từ dưới
      overlay.classList.add('visible');
      aceWrap.classList.add('draw');

      // Bước 2 – Xoay + phóng to
      setTimeout(() => {
        aceWrap.classList.add('expand');
      }, 3200);

      // Bước 3 – Chuyển trang game; nhạc tắt tự nhiên khi unload
      setTimeout(() => {
        window.location.href = '/game';
      }, 4900);
    });
  </script>
</body>
</html>